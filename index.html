<!doctype html>
<html lang="pt-BR">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>Tarefas</title>
  </head>
  <body class="bg-dark">
    <div class="row col-12 d-flex justify-content-center">
        <div class="col-10 mt-5 col-sm-5">
            <div class="card" style="background-color: #222;">
                <div class="card-header">
                    <h1 class="text-white">Lista de tarefas</h1>
                </div>
                <div class="card-body" id="taskList">
                    <div class="input-group mb-3" id="addNewTaskDiv">
                        <div class="input-group-text">
                          <input class="form-check-input mt-0" type="checkbox" value="" aria-label="Checkbox for following text input" disabled>
                        </div>
                        <input id="newTaskContent" type="text" class="form-control" aria-label="Text input with checkbox" placeholder="Adicione uma tarefa">
                        <button class="btn btn-outline-secondary" type="button" id="addNewTask" onClick="addNewTask();"><i class="fa fa-check"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>

        var editInProgress = [];
        var lastID = 0;

        const deleteByID = (id) => {
            document.getElementById(`container__${id}`).remove();
        }

		const toggleTaskCompletedByID = (id) => {
			if (document.getElementById(`checkbox__${id}`).checked){
				document.getElementById(`task__${id}`).classList.add(`text-decoration-line-through`);
			} else {
				document.getElementById(`task__${id}`).classList.remove(`text-decoration-line-through`);
			}
		}

        const toogleTaskEditByID = (id) => {
            if (document.getElementById(`task__${id}`).disabled){
                document.getElementById(`task__${id}`).disabled = false;
                document.getElementById(`edit__${id}`).innerHTML = `<i class="fa fa-check"></i>`;
            } else {
                document.getElementById(`task__${id}`).disabled = true;
                document.getElementById(`edit__${id}`).innerHTML = `<i class="fa fa-edit"></i>`;
            }

            // Remover caso a tarefa esteja em branco
            if (document.getElementById(`task__${id}`).value == ``){
                deleteByID(id);
            }
        }

        const addNewTask = () => {
            var newTaskContent = document.getElementById(`newTaskContent`).value;
            if (newTaskContent !== ``){
                document.getElementById(`taskList`).innerHTML += newTask(newTaskContent);
                document.getElementById(`newTaskContent`).value = ``;
                const tempDiv = document.getElementById(`addNewTaskDiv`);
                document.getElementById(`addNewTaskDiv`).remove();
                document.getElementById(`taskList`).appendChild(tempDiv);
            }
        }

        const newTask = (title) => {
            var id = lastID++;
            return `<div id="container__${id}" class="input-group mb-3">
                <div class="input-group-text">
                    <input id="checkbox__${id}" onclick="toggleTaskCompletedByID(${id})" class="form-check-input mt-0" type="checkbox" value="" aria-label="Checkbox for following text input">
                </div>
                <input id="task__${id}" type="text" class="form-control" aria-label="Text input with checkbox" value="${title}" disabled>
                <button id="edit__${id}" class="btn btn-outline-secondary" type="button" onClick="toogleTaskEditByID(${id});"><i class="fa fa-edit"></i></button>
                <button id="delete__${id}" class="btn btn-outline-secondary" type="button" onClick="deleteByID(${id});"><i class="fa fa-trash"></i></button>
            </div>`;
        }
    </script>
  </body>
</html>